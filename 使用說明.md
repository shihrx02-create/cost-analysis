# 成本分析 HTML 產生器 - 使用說明

## 📋 概述
此工具能自動將 Excel 資料轉換為格式統一的成本分析 HTML 報表，支援多種幣別轉換，包括中英文對照。

## 🚀 快速開始

### 第一步：打開產生器
1. 在瀏覽器中打開 `cost-analysis-generator.html` 檔案
2. 你會看到一個友善的表單介面

### 第二步：準備資料
使用提供的範本 `template.csv` 或按照以下格式準備：

#### 支援的檔案格式

1. **Excel 檔案（推薦）**
   - 格式：`.xlsx` 或 `.xls`
   - 最佳相容性和解析準確度
   - 支援複雜的表格結構

2. **PDF 檔案**
   - 格式：`.pdf`
   - 系統會自動提取表格資料
   - 適合從現有報表轉換
   - 注意：PDF 提取效果取決於 PDF 的結構化程度

#### Excel 欄位說明：

| 欄位 | 說明 | 例子 |
|------|------|------|
| 項目 | 產品項目名稱（中文） | 總投入數量 |
| Item | 產品項目名稱（英文） | Total Input Quantity |
| 狀況 | 資料的分類：現況、評估或工序 | 現況 |
| Status | 英文分類 | Current |
| 數量 | 產品數量 | 3150 |
| Quantity | 英文數量標籤 | 3150 |
| 百分比 | 百分比值 | 14% |
| Percentage | 英文百分比標籤 | 14% |
| 成本(台幣) | 台幣金額（必填，用於自動轉換） | 7730 |
| Cost(TWD) | 英文成本標籤 | 7730 |

#### 資料分類：
- **現況 (Current)**: 現況成本分析資料
- **評估 (Evaluation)**: 評估報價資料
- **工序 (Process)**: 工序比較資料

### 第三步：填寫表單

1. **上傳檔案**
   - 支援格式：`.xlsx`, `.xls`, `.csv`
   - 點擊「上傳」按鈕選擇準備好的 Excel 檔案

2. **輸入產品 ID**
   - 例如：`3-041004-032PN-0`
   - 此 ID 會顯示在報表標題中

3. **選擇幣別**
   - 美金 (USD)
   - 歐元 (EUR)
   - 澳幣 (AUD)
   - 英鎊 (GBP)

4. **輸入匯率**
   - 輸入「台幣/外幣」的匯率
   - 例如：美金匯率 31.5 代表 1 USD = 31.5 TWD
   - **計算方式**：台幣金額 ÷ 匯率 = 外幣金額
   - **精度**：自動取到小數點第 3 位

### 第四步：預覽和下載

1. 點擊「預覽資料」按鈕
   - 系統會顯示解析後的 Excel 資料表格
   - 確認資料無誤

2. （可選）輸入自訂檔案名稱
   - 如不輸入，將使用產品 ID 作為檔案名稱

3. 點擊「確認並下載 HTML 檔案」
   - 系統會自動生成並下載成本分析 HTML 報表

## 📊 生成的 HTML 特性

### 版面設計
- **左右雙欄佈局**：現況和評估並排顯示
- **表格格式化**：專業的邊框和顏色配置
- **中英文對照**：所有項目都有中英文標籤

### 自動功能
- ✅ 自動轉換幣別（根據輸入的匯率）
- ✅ 自動計算保留小數點 3 位
- ✅ 自動高亮「單顆成本」行
- ✅ 自動添加匯率說明
- ✅ 自動記錄產生時間

### 匯率轉換說明
在生成的 HTML 報表中，會自動添加以下說明：
```
幣別轉換說明: 單位為 [幣別] | 匯率: 1 [幣別] = TWD [匯率] | 
計算方式: 台幣金額 ÷ [匯率]，取到小數點第 3 位
```

## 💡 使用範例

### 範例場景
- 產品 ID：3-041004-032PN-0
- 幣別：美金 (USD)
- 匯率：31.5
- 台幣金額：7,730 TWD

### 計算過程
```
7,730 ÷ 31.5 = 245.238... → 245.238 USD (取到小數點第 3 位)
```

## ⚠️ 常見問題

### Q: 支援 PDF 上傳嗎？
A: 支援！系統會自動提取 PDF 中的表格資料。為了獲得最佳結果：
   - 確保 PDF 包含結構化的表格
   - 如果 PDF 格式複雜，建議先將其轉換為 Excel 再上傳
   - 提取後請在預覽中確認資料是否正確

### Q: 如何修改生成的 HTML？
A: 生成的 HTML 可用任何文本編輯器打開編輯。建議使用 VS Code 或 Sublime Text。

### Q: 匯率應該如何設定？
A: 輸入「台幣/外幣」的匯率。例如：
- 1 USD = 31.5 TWD → 輸入 31.5
- 1 EUR = 34 TWD → 輸入 34

### Q: 可以一次生成多個不同幣別的報表嗎？
A: 可以。重複使用工具，每次選擇不同的幣別和匯率即可。

## 📁 檔案結構

```
成本分析/
├── cost-analysis-generator.html    ← 主工具（在瀏覽器打開）
├── template.csv                     ← 資料範本
├── 使用說明.md                      ← 本檔案
├── 3-041004-032PN-0.html           ← 參考範例
└── [其他產品 HTML 報表]
```

## 🔧 技術詳情

### 支援的瀏覽器
- Chrome / Edge（推薦）
- Firefox
- Safari
- 任何支援 ES6 和 XLSX 的現代瀏覽器

### 外部依賴
- XLSX 庫（用於 Excel 解析）：https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.min.js

### 本地運行
由於使用了 JavaScript 檔案 API，建議：
1. 將 HTML 檔案放在本地
2. 用瀏覽器打開（不需要伺服器）
3. 資料不會上傳到任何遠端服務

## 📝 最佳實踐

### 準備資料時
1. ✅ 確保所有台幣金額都填寫在「成本(台幣)」欄位
2. ✅ 在「狀況」欄選擇正確的分類：現況、評估、工序
3. ✅ 中英文對照要保持一致
4. ✅ 檢查數字格式（避免額外空格或符號）

### 生成報表時
1. ✅ 確保匯率輸入正確
2. ✅ 驗證預覽中的資料正確性
3. ✅ 下載前檢查檔案名稱

### 優化工作流程
1. 保存一份標準的 Excel 範本
2. 每次複製範本後修改數據
3. 批量生成多個幣別的報表

## 📞 支援

若遇到問題：
1. 檢查 Excel 格式是否符合範本
2. 確保瀏覽器是最新版本
3. 清除瀏覽器快取後重試
4. 查看瀏覽器的開發者工具（F12）中的錯誤訊息

---

**版本**: 1.0  
**最後更新**: 2025 年 12 月  
**作者**: 成本分析團隊